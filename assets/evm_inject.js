(()=>{var{defineProperty:u,getOwnPropertyNames:f,getOwnPropertyDescriptor:w}=Object,P=Object.prototype.hasOwnProperty;var m=new WeakMap,b=(e)=>{var t=m.get(e),r;if(t)return t;if(t=u({},"__esModule",{value:!0}),e&&typeof e==="object"||typeof e==="function")f(e).map((n)=>!P.call(t,n)&&u(t,n,{get:()=>e[n],enumerable:!(r=w(e,n))||r.enumerable}));return m.set(e,t),t};var E=(e,t)=>{for(var r in t)u(e,r,{get:t[r],enumerable:!0,configurable:!0,set:(n)=>t[r]=()=>n})};var k={};E(k,{ZilPayProviderImpl:()=>v});function p(){let e=globalThis.document.querySelector("link[rel*=\'icon\']");if(!e)throw new Error("website favicon is required");return e.href}function y(){if(typeof document==="undefined")return{description:null,title:null,colors:null};let e=document.getElementsByTagName("meta"),t=null,r=null;for(let i=0;i<e.length;i++){let o=e[i],h=o.getAttribute("name"),g=o.getAttribute("content");if(!h||!g)continue;switch(h.toLowerCase()){case"description":t=g;break;case"title":r=g;break}}let n=window.getComputedStyle(document.body),a=document.querySelector("button"),s=a?window.getComputedStyle(a):null,c=a?window.getComputedStyle(a,":hover"):null,l={background:d(n.backgroundColor),text:d(n.color),primary:s?d(s.backgroundColor):void 0,secondary:c&&c.backgroundColor!==s?.backgroundColor?d(c.backgroundColor):s?d(s.backgroundColor):void 0};return{description:t,title:r,colors:l}}function d(e){let t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(!t)return e;let r=parseInt(t[1]).toString(16).padStart(2,"0"),n=parseInt(t[2]).toString(16).padStart(2,"0"),a=parseInt(t[3]).toString(16).padStart(2,"0");return`#${r}${n}${a}`}class v{isZilPay=!0;supportedMethods=new Set(["eth_requestAccounts","eth_accounts","eth_sendTransaction","eth_getBalance","eth_getTransactionByHash","eth_getTransactionReceipt","eth_call","eth_estimateGas","eth_blockNumber","eth_getBlockByNumber","eth_getBlockByHash","eth_subscribe","eth_unsubscribe","net_version","eth_chainId","eth_getCode","eth_getStorageAt","eth_gasPrice","eth_signTypedData","eth_signTypedData_v4","eth_getTransactionCount","personal_sign","eth_sign","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_watchAsset","wallet_getPermissions","wallet_requestPermissions","wallet_scanQRCode","eth_getEncryptionPublicKey","eth_decrypt"]);#e=new Map;constructor(){this.#t(),this.#n()}#t(){this.#e.set("connect",new Set),this.#e.set("disconnect",new Set),this.#e.set("chainChanged",new Set),this.#e.set("accountsChanged",new Set),this.#e.set("message",new Set)}#n(){if(typeof window!=="undefined"&&window)window.handleZilPayEvent=(e)=>{let t=this.#e.get(e.event);if(t)switch(e.event){case"connect":t.forEach((n)=>n(e.data));break;case"disconnect":t.forEach((n)=>n(e.data));break;case"chainChanged":let r=e.data;if(typeof r!=="string"||!r.startsWith("0x")){console.warn("Invalid chainId format for chainChanged event");return}t.forEach((n)=>n(r));break;case"accountsChanged":t.forEach((n)=>n(e.data));break;case"message":t.forEach((n)=>n(e.data));break}}}async request(e){if(!this.supportedMethods.has(e.method))return Promise.reject({message:"Unsupported method",code:4200,data:{method:e.method}});let t=p();return new Promise((r,n)=>{let a=Math.random().toString(36).substring(2),s=y(),c={type:"ZILPAY_REQUEST",uuid:a,payload:e,icon:t,...s};if(typeof window==="undefined"||!window||!window.EIP1193Channel){n({message:"ZilPay channel is not available",code:4900,data:null});return}try{window.EIP1193Channel.postMessage(JSON.stringify(c))}catch(i){n({message:`Failed to send request: ${i.message}`,code:4000,data:i});return}let l=(i)=>{let o=i.data;if(o.type==="ZILPAY_RESPONSE"&&o.uuid===a){if(o.payload.error)n({message:o.payload.error.message,code:o.payload.error.code||4000,data:o.payload.error.data});else r(o.payload.result);window.removeEventListener("message",l)}};window.addEventListener("message",l)})}async enable(){return this.request({method:"eth_requestAccounts"})}on(e,t){let r=this.#e.get(e);if(r)r.add(t)}removeListener(e,t){let r=this.#e.get(e);if(r)r.delete(t)}}(function(){if(typeof window==="undefined"||!window){console.warn("No window object available for ZilPay injection");return}try{if("ethereum"in window&&window.ethereum){console.warn("Ethereum provider already exists in window");return}let e=new v;try{Object.defineProperty(window,"ethereum",{value:e,writable:!1,configurable:!0})}catch(t){window.ethereum=e,console.warn("Using fallback assignment for ethereum due to:",t)}window.dispatchEvent(new Event("ethereum#initialized")),console.log("Ethereum provider injected successfully")}catch(e){console.error("Failed to inject Ethereum provider:",e)}})();})();
